<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Post Image</title>
	<link href="https://fonts.googleapis.com/css?family=Poppins&display=swap" rel="stylesheet">
	<link type="text/css" rel="stylesheet" href="/public/stylesheets/main.css" />
	<link type="text/css" rel="stylesheet" href="/public/stylesheets/postimage.css" />
	<script defer src="/public/javascripts/frontend.js"></script>
	<script defer src="/public/javascripts/slide.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<link rel="icon" href="/public/images/browser-icon.png">
</head>

<body>
	<nav>
		<div id="nav-logo">
            <a href="/"><img src="/public/images/nav-logo.png"></a>
        </div>
		<div class="nav-bar">
			<div class="nav-links">
				<a href="/">HOME</a>


				<div class="right-nav">
					<a href="/login" id="login" name="login" class="nav-buttons">LOGIN</a>
				</div>
			</div>
		</div>

		<div class="burger">
			<div class="line1"></div>
			<div class="line2"></div>
			<div class="line3"></div>
		</div>
	</nav>

	<section>
		<div class="postimage">
			<h1>Post Image</h1>
			<form id="post-image" class="postimageform"  method="POST"
				enctype="multipart/form-data">

				<!--action="/posts/createPost"-->

				<label for="title">Title</label><br>
				<input type="text" name="title" id="title" placeholder="Enter Title" /><br>

				<label for="description">Description</label><br>
				<input type="text" name="description" id="description" placeholder="Enter Description" /><br>

				<div class="uploadimage">
					<input type="file" name="uploadImage" id="img"><br>
				</div>

				<div class="aup">
					<input type="checkbox" name="AUP" id="AUP" />
					<label for="AUP"> I accept the <a href="">Acceptable Use Policy</a></label><br>
				</div>

				<input type="submit" value="Post Image">
			</form>
		</div>
	</section>

	<script>
		const _form = document.getElementById("post-image");
		_form.onsubmit = function(event) {
			event.preventDefault();
			let _body = new FormData(_form);

			/*
			fetch('/posts/createPost', {
				body:_body,
				method:"POST"
			})
			.then((data) => {
				console.log(data);
				return data.json();
			})
			.then((dataAsObject) => {
				console.log(dataAsObject);
				alert(dataAsObject.message);
				location.replace(dataAsObject.redirect);
			})
			.catch(err => console.log(err));*/

			axios('/posts/createPost', {
				data:_body,
				method:"POST"
			})		
			.then((data) => {
				console.log(data.data);
				alert(data.data.message);
				location.replace(data.data.redirect);
			})
			.catch(err => console.log(err));
			
		}
	</script>

</body>

</html>